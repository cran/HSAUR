
R : Copyright 2006, The R Foundation for Statistical Computing
Version 2.3.0 (2006-04-24)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", width = 63, # digits = 4,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1))))
R> HSAURpkg <- require("HSAUR")
Loading required package: HSAUR
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR"))
R> rm(HSAURpkg)
R> 
R> 
R> ###################################################
R> ### chunk number 2: MLR-clouds-boxplots
R> ###################################################
R> data("clouds", package = "HSAUR")
R> layout(matrix(1:2, nrow = 2))
R> bxpseeding <- boxplot(rainfall ~ seeding, data = clouds, ylab = "Rainfall",
+         xlab = "Seeding")
R> bxpecho <- boxplot(rainfall ~ echomotion, data = clouds, ylab = "Rainfall",
+         xlab = "Echo Motion")
R> 
R> 
R> ###################################################
R> ### chunk number 3: MLR-clouds-scatterplots
R> ###################################################
R> layout(matrix(1:4, nrow = 2))
R> plot(rainfall ~ time, data = clouds)
R> plot(rainfall ~ sne, data = clouds, xlab="S-NE criterion")
R> plot(rainfall ~ cloudcover, data = clouds)
R> plot(rainfall ~ prewetness, data = clouds)
R> 
R> 
R> ###################################################
R> ### chunk number 4: MLR-clouds-outliers
R> ###################################################
R> rownames(clouds)[clouds$rainfall %in% c(bxpseeding$out, bxpecho$out)]
[1] "1"  "15"
R> 
R> 
R> ###################################################
R> ### chunk number 5: MLR-clouds-formula
R> ###################################################
R> clouds_formula <- rainfall ~ seeding * (sne + cloudcover +
+     prewetness + echomotion) + time
R> 
R> 
R> ###################################################
R> ### chunk number 6: MLR-clouds-modelmatrix
R> ###################################################
R> Xstar <- model.matrix(clouds_formula, data = clouds)
R> 
R> 
R> ###################################################
R> ### chunk number 7: MLR-clouds-contrasts
R> ###################################################
R> attr(Xstar, "contrasts")
$seeding
[1] "contr.treatment"

$echomotion
[1] "contr.treatment"

R> 
R> 
R> ###################################################
R> ### chunk number 8: MLR-clouds-lm
R> ###################################################
R> clouds_lm <- lm(clouds_formula, data = clouds)
R> class(clouds_lm)
[1] "lm"
R> 
R> 
R> ###################################################
R> ### chunk number 9: MLR-clouds-summary
R> ###################################################
R> summary(clouds_lm)

Call:
lm(formula = clouds_formula, data = clouds)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5259 -1.1486 -0.2704  1.0401  4.3913 

Coefficients:
                                Estimate Std. Error t value
(Intercept)                     -0.34624    2.78773  -0.124
seedingyes                      15.68293    4.44627   3.527
sne                              0.38786    0.21786   1.780
cloudcover                       0.41981    0.84453   0.497
prewetness                       4.10834    3.60101   1.141
echomotionstationary             3.15281    1.93253   1.631
time                            -0.04497    0.02505  -1.795
seedingyes:sne                  -0.48625    0.24106  -2.017
seedingyes:cloudcover           -3.19719    1.26707  -2.523
seedingyes:prewetness           -2.55707    4.48090  -0.571
seedingyes:echomotionstationary -0.56222    2.64430  -0.213
                                Pr(>|t|)   
(Intercept)                      0.90306   
seedingyes                       0.00372 **
sne                              0.09839 . 
cloudcover                       0.62742   
prewetness                       0.27450   
echomotionstationary             0.12677   
time                             0.09590 . 
seedingyes:sne                   0.06482 . 
seedingyes:cloudcover            0.02545 * 
seedingyes:prewetness            0.57796   
seedingyes:echomotionstationary  0.83492   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 2.205 on 13 degrees of freedom
Multiple R-Squared: 0.7158,	Adjusted R-squared: 0.4972 
F-statistic: 3.274 on 10 and 13 DF,  p-value: 0.02431 

R> 
R> 
R> ###################################################
R> ### chunk number 10: MLR-clouds-coef
R> ###################################################
R> betastar <- coef(clouds_lm)
R> betastar
                    (Intercept) 
                    -0.34624093 
                     seedingyes 
                    15.68293481 
                            sne 
                     0.38786207 
                     cloudcover 
                     0.41981393 
                     prewetness 
                     4.10834188 
           echomotionstationary 
                     3.15281358 
                           time 
                    -0.04497427 
                 seedingyes:sne 
                    -0.48625492 
          seedingyes:cloudcover 
                    -3.19719006 
          seedingyes:prewetness 
                    -2.55706696 
seedingyes:echomotionstationary 
                    -0.56221845 
R> 
R> 
R> ###################################################
R> ### chunk number 11: MLR-clouds-vcov
R> ###################################################
R> Vbetastar <- vcov(clouds_lm)
R> 
R> 
R> ###################################################
R> ### chunk number 12: MLR-clouds-sd
R> ###################################################
R> sqrt(diag(Vbetastar))
                    (Intercept) 
                     2.78773403 
                     seedingyes 
                     4.44626606 
                            sne 
                     0.21785501 
                     cloudcover 
                     0.84452994 
                     prewetness 
                     3.60100694 
           echomotionstationary 
                     1.93252592 
                           time 
                     0.02505286 
                 seedingyes:sne 
                     0.24106012 
          seedingyes:cloudcover 
                     1.26707204 
          seedingyes:prewetness 
                     4.48089584 
seedingyes:echomotionstationary 
                     2.64429975 
R> 
R> 
R> ###################################################
R> ### chunk number 13: MLR-clouds-lmplot
R> ###################################################
R> psymb <- as.numeric(clouds$seeding)
R> plot(rainfall ~ cloudcover, data = clouds, pch = psymb)
R> abline(lm(rainfall ~ cloudcover, data = clouds, subset = seeding == "no"))
R> abline(lm(rainfall ~ cloudcover, data = clouds, subset = seeding == "yes"), lty = 2)
R> legend("topright", legend = c("No seeding", "Seeding"), pch = 1:2, lty = 1:2, bty = "n")
R> 
R> 
R> ###################################################
R> ### chunk number 14: MLR-clouds-residfitted
R> ###################################################
R> clouds_resid <- residuals(clouds_lm)
R> clouds_fitted <- fitted(clouds_lm)
R> 
R> 
R> ###################################################
R> ### chunk number 15: MLR-clouds-residplot
R> ###################################################
R> plot(clouds_fitted, clouds_resid, xlab = "Fitted values",
+      ylab = "Residuals", ylim = max(abs(clouds_resid)) * c(-1, 1),
+      type = "n")
R> abline(h = 0, lty = 2)
R> text(clouds_fitted, clouds_resid, labels = rownames(clouds))
R> 
R> 
R> ###################################################
R> ### chunk number 16: MLR-clouds-qqplot
R> ###################################################
R> qqnorm(clouds_resid, ylab = "Residuals")
R> qqline(clouds_resid)
R> 
R> 
R> ###################################################
R> ### chunk number 17: MLR-clouds-cook eval=FALSE
R> ###################################################
R> ## plot(clouds_lm)
R> 
R> 
R> ###################################################
R> ### chunk number 18: MLR-clouds-cook
R> ###################################################
R> plot(clouds_lm, which = 4, sub.caption = NULL)
R> 
R> 
R> 
