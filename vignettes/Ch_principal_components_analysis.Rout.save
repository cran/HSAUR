
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.2.1 beta (2005-12-18 r36792)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", width = 63, # digits = 4,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1))))
R> HSAURpkg <- require("HSAUR")
Loading required package: HSAUR
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR"))
R> rm(HSAURpkg)
R> 
R> 
R> ###################################################
R> ### chunk number 2: PCA-heptathlon-recode
R> ###################################################
R> data("heptathlon", package = "HSAUR")
R> heptathlon$hurdles <- max(heptathlon$hurdles) - heptathlon$hurdles
R> heptathlon$run200m <- max(heptathlon$run200m) - heptathlon$run200m
R> heptathlon$run800m <- max(heptathlon$run800m) - heptathlon$run800m
R> 
R> 
R> ###################################################
R> ### chunk number 3: PCA-heptathlon-scatter
R> ###################################################
R> score <- which(colnames(heptathlon) == "score")
R> plot(heptathlon[,-score])
R> 
R> 
R> ###################################################
R> ### chunk number 4: PCA-options65
R> ###################################################
R> w <- options("width")
R> options(width = 65)
R> 
R> 
R> ###################################################
R> ### chunk number 5: PCA-heptathlon-cor
R> ###################################################
R> round(cor(heptathlon[,-score]), 2)
         hurdles highjump shot run200m longjump javelin run800m
hurdles     1.00     0.81 0.65    0.77     0.91    0.01    0.78
highjump    0.81     1.00 0.44    0.49     0.78    0.00    0.59
shot        0.65     0.44 1.00    0.68     0.74    0.27    0.42
run200m     0.77     0.49 0.68    1.00     0.82    0.33    0.62
longjump    0.91     0.78 0.74    0.82     1.00    0.07    0.70
javelin     0.01     0.00 0.27    0.33     0.07    1.00   -0.02
run800m     0.78     0.59 0.42    0.62     0.70   -0.02    1.00
R> 
R> 
R> ###################################################
R> ### chunk number 6: PCA-optionsw
R> ###################################################
R> options(width = w$width)
R> 
R> 
R> ###################################################
R> ### chunk number 7: PCA-heptathlon-pca
R> ###################################################
R> heptathlon_pca <- prcomp(heptathlon[, -score], scale = TRUE)
R> print(heptathlon_pca)
Standard deviations:
[1] 2.1119364 1.0928497 0.7218131 0.6761411 0.4952441 0.2701029
[7] 0.2213617

Rotation:
                PC1         PC2         PC3         PC4
hurdles  -0.4528710  0.15792058 -0.04514996  0.02653873
highjump -0.3771992  0.24807386 -0.36777902  0.67999172
shot     -0.3630725 -0.28940743  0.67618919  0.12431725
run200m  -0.4078950 -0.26038545  0.08359211 -0.36106580
longjump -0.4562318  0.05587394  0.13931653  0.11129249
javelin  -0.0754090 -0.84169212 -0.47156016  0.12079924
run800m  -0.3749594  0.22448984 -0.39585671 -0.60341130
                 PC5         PC6         PC7
hurdles  -0.09494792 -0.78334101  0.38024707
highjump  0.01879888  0.09939981 -0.43393114
shot      0.51165201 -0.05085983 -0.21762491
run200m  -0.64983404  0.02495639 -0.45338483
longjump -0.18429810  0.59020972  0.61206388
javelin   0.13510669 -0.02724076  0.17294667
run800m   0.50432116  0.15555520 -0.09830963
R> 
R> 
R> ###################################################
R> ### chunk number 8: PCA-heptathlon-summary
R> ###################################################
R> summary(heptathlon_pca)
Importance of components:
                         PC1   PC2    PC3    PC4    PC5    PC6
Standard deviation     2.112 1.093 0.7218 0.6761 0.4952 0.2701
Proportion of Variance 0.637 0.171 0.0744 0.0653 0.0350 0.0104
Cumulative Proportion  0.637 0.808 0.8822 0.9475 0.9826 0.9930
                         PC7
Standard deviation     0.221
Proportion of Variance 0.007
Cumulative Proportion  1.000
R> 
R> 
R> ###################################################
R> ### chunk number 9: PCA-heptathlon-a1
R> ###################################################
R> a1 <- heptathlon_pca$rotation[,1]
R> a1
   hurdles   highjump       shot    run200m   longjump 
-0.4528710 -0.3771992 -0.3630725 -0.4078950 -0.4562318 
   javelin    run800m 
-0.0754090 -0.3749594 
R> 
R> 
R> ###################################################
R> ### chunk number 10: PCA-heptathlon-scaling
R> ###################################################
R> center <- heptathlon_pca$center
R> scale <- heptathlon_pca$scale
R> 
R> 
R> ###################################################
R> ### chunk number 11: PCA-heptathlon-s1
R> ###################################################
R> hm <- as.matrix(heptathlon[,-score])
R> drop(scale(hm, center = center, scale = scale) %*% heptathlon_pca$rotation[,1])
Joyner-Kersee (USA)          John (GDR)        Behmer (GDR) 
       -4.121447626        -2.882185935        -2.649633766 
 Sablovskaite (URS)   Choubenkova (URS)        Schulz (GDR) 
       -1.343351210        -1.359025696        -1.043847471 
      Fleming (AUS)       Greiner (USA)    Lajbnerova (CZE) 
       -1.100385639        -0.923173639        -0.530250689 
      Bouraga (URS)       Wijnsma (HOL)     Dimitrova (BUL) 
       -0.759819024        -0.556268302        -1.186453832 
     Scheider (SWI)         Braun (FRG)  Ruotsalainen (FIN) 
        0.015461226         0.003774223         0.090747709 
       Yuping (CHN)         Hagger (GB)         Brown (USA) 
       -0.137225440         0.171128651         0.519252646 
      Mulliner (GB)    Hautenauve (BEL)        Kytola (FIN) 
        1.125481833         1.085697646         1.447055499 
     Geremias (BRA)       Hui-Ing (TAI)      Jeong-Mi (KOR) 
        2.014029620         2.880298635         2.970118607 
        Launa (PNG) 
        6.270021972 
R> 
R> 
R> ###################################################
R> ### chunk number 12: PCA-heptathlon-s1
R> ###################################################
R> predict(heptathlon_pca)[,1]
Joyner-Kersee (USA)          John (GDR)        Behmer (GDR) 
       -4.121447626        -2.882185935        -2.649633766 
 Sablovskaite (URS)   Choubenkova (URS)        Schulz (GDR) 
       -1.343351210        -1.359025696        -1.043847471 
      Fleming (AUS)       Greiner (USA)    Lajbnerova (CZE) 
       -1.100385639        -0.923173639        -0.530250689 
      Bouraga (URS)       Wijnsma (HOL)     Dimitrova (BUL) 
       -0.759819024        -0.556268302        -1.186453832 
     Scheider (SWI)         Braun (FRG)  Ruotsalainen (FIN) 
        0.015461226         0.003774223         0.090747709 
       Yuping (CHN)         Hagger (GB)         Brown (USA) 
       -0.137225440         0.171128651         0.519252646 
      Mulliner (GB)    Hautenauve (BEL)        Kytola (FIN) 
        1.125481833         1.085697646         1.447055499 
     Geremias (BRA)       Hui-Ing (TAI)      Jeong-Mi (KOR) 
        2.014029620         2.880298635         2.970118607 
        Launa (PNG) 
        6.270021972 
R> 
R> 
R> ###################################################
R> ### chunk number 13: PCA-heptathlon-pca-plot
R> ###################################################
R> plot(heptathlon_pca)
R> 
R> 
R> ###################################################
R> ### chunk number 14: PCA-heptathlon-sdev
R> ###################################################
R> sdev <- heptathlon_pca$sdev
R> prop12 <- round(sum(sdev[1:2]^2)/sum(sdev^2)*100, 0)
R> 
R> 
R> ###################################################
R> ### chunk number 15: PCA-heptathlon-PCscatter eval=FALSE
R> ###################################################
R> ## biplot(heptathlon_pca, col = c("gray", "black"))
R> 
R> 
R> ###################################################
R> ### chunk number 16: PCA-heptathlon-PCscatter
R> ###################################################
R> tmp <- heptathlon[, -score]
R> rownames(tmp) <- abbreviate(gsub(" \\(.*", "", rownames(tmp)))
R> biplot(prcomp(tmp, scale = TRUE), col = c("black", "lightgray"), xlim =
+ c(-0.5, 0.7))
R> 
R> 
R> ###################################################
R> ### chunk number 17: PCA-scorecor
R> ###################################################
R> cor(heptathlon$score, heptathlon_pca$x[,1])
[1] -0.9910978
R> 
R> 
R> ###################################################
R> ### chunk number 18: PCA-heptathlonscore
R> ###################################################
R> plot(heptathlon$score, heptathlon_pca$x[,1])
R> 
R> 
R> 
