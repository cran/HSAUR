
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.2.1 beta (2005-12-18 r36792)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", width = 63, # digits = 4,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1))))
R> HSAURpkg <- require("HSAUR")
Loading required package: HSAUR
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR"))
R> rm(HSAURpkg)
R> 
R> 
R> ###################################################
R> ### chunk number 2: SI-setup
R> ###################################################
R> library("vcd")
Loading required package: grid
Loading required package: colorspace

Attaching package: 'colorspace'


	The following object(s) are masked from package:grDevices :

	 hcl 

R> 
R> 
R> ###################################################
R> ### chunk number 3: SI-roomwidth-data
R> ###################################################
R> data("roomwidth", package = "HSAUR")
R> 
R> 
R> ###################################################
R> ### chunk number 4: SI-roomwidth-convert
R> ###################################################
R> convert <- ifelse(roomwidth$unit == "feet", 1, 3.28)
R> 
R> 
R> ###################################################
R> ### chunk number 5: SI-roomwidth-summary
R> ###################################################
R> tapply(roomwidth$width * convert, roomwidth$unit, summary)
$feet
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   24.0    36.0    42.0    43.7    48.0    94.0 

$metres
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  26.24   36.08   49.20   52.55   55.76  131.20 

R> tapply(roomwidth$width * convert, roomwidth$unit, sd)
    feet   metres 
12.49742 23.43444 
R> 
R> 
R> ###################################################
R> ### chunk number 6: SI-roomwidth-boxplot
R> ###################################################
R> layout(matrix(c(1,2,1,3), nrow = 2, ncol = 2, byrow = FALSE))
R> boxplot(I(width * convert) ~ unit, data = roomwidth,
+         ylab = "Estimated width (feet)",
+         var.width = TRUE, names = c("Estimates in feet",
+         "Estimates in metres (converted to feet)"))
R> feet <- roomwidth$unit == "feet"
R> qqnorm(roomwidth$width[feet], ylab = "Estimated width (feet)")
R> qqline(roomwidth$width[feet])
R> qqnorm(roomwidth$width[!feet], ylab = "Estimated width (metres)")
R> qqline(roomwidth$width[!feet])
R> 
R> 
R> ###################################################
R> ### chunk number 7: SI-roomwidth-formula
R> ###################################################
R> I(width * convert) ~ unit
I(width * convert) ~ unit
R> 
R> 
R> ###################################################
R> ### chunk number 8: SI-roomwidth-tt-T-hide
R> ###################################################
R> tt <- t.test(I(width * convert) ~ unit, data = roomwidth, var.equal = TRUE)
R> 
R> 
R> ###################################################
R> ### chunk number 9: SI-roomwidth-tt-T
R> ###################################################
R> t.test(I(width * convert) ~ unit, data = roomwidth, var.equal = TRUE)

	Two Sample t-test

data:  I(width * convert) by unit 
t = -2.6147, df = 111, p-value = 0.01017
alternative hypothesis: true difference in means is not equal to 0 
95 percent confidence interval:
 -15.572734  -2.145052 
sample estimates:
  mean in group feet mean in group metres 
            43.69565             52.55455 

R> 
R> 
R> ###################################################
R> ### chunk number 10: SI-roomwidth-tt-F
R> ###################################################
R> t.test(I(width * convert) ~ unit, data = roomwidth, var.equal = FALSE)

	Welch Two Sample t-test

data:  I(width * convert) by unit 
t = -2.3071, df = 58.788, p-value = 0.02459
alternative hypothesis: true difference in means is not equal to 0 
95 percent confidence interval:
 -16.54308  -1.17471 
sample estimates:
  mean in group feet mean in group metres 
            43.69565             52.55455 

R> 
R> 
R> ###################################################
R> ### chunk number 11: SI-roomwidth-wt
R> ###################################################
R> wilcox.test(I(width * convert) ~ unit, data = roomwidth, conf.int = TRUE)

	Wilcoxon rank sum test with continuity correction

data:  I(width * convert) by unit 
W = 1145, p-value = 0.02815
alternative hypothesis: true mu is not equal to 0 
95 percent confidence interval:
 -9.3599953 -0.8000423 
sample estimates:
difference in location 
             -5.279955 

R> 
R> 
R> ###################################################
R> ### chunk number 12: SI-roomwidth-wt-hide
R> ###################################################
R> pwt <- round(wilcox.test(I(width * convert) ~ unit, data =
+ roomwidth)$p.value, 3)
R> 
R> 
R> ###################################################
R> ### chunk number 13: SI-waves-data
R> ###################################################
R> data("waves", package = "HSAUR")
R> 
R> 
R> ###################################################
R> ### chunk number 14: SI-wavese-boxplot
R> ###################################################
R> mooringdiff <- waves$method1 - waves$method2
R> layout(matrix(1:2, ncol = 2))
R> boxplot(mooringdiff, ylab = "Differences (Newton metres)", main = "Boxplot")
R> abline(h = 0, lty = 2)
R> qqnorm(mooringdiff, ylab = "Differences (Newton metres)")
R> qqline(mooringdiff)
R> 
R> 
R> ###################################################
R> ### chunk number 15: SI-waves-tt
R> ###################################################
R> t.test(mooringdiff)

	One Sample t-test

data:  mooringdiff 
t = 0.9019, df = 17, p-value = 0.3797
alternative hypothesis: true mean is not equal to 0 
95 percent confidence interval:
 -0.08258476  0.20591810 
sample estimates:
 mean of x 
0.06166667 

R> 
R> 
R> ###################################################
R> ### chunk number 16: SI-waves-wt
R> ###################################################
R> pwt <- round(wilcox.test(mooringdiff)$p.value, 3)
Warning message:
cannot compute exact p-value with ties in: wilcox.test.default(mooringdiff) 
R> 
R> 
R> ###################################################
R> ### chunk number 17: SI-waves-wt
R> ###################################################
R> wilcox.test(mooringdiff)

	Wilcoxon signed rank test with continuity correction

data:  mooringdiff 
V = 109, p-value = 0.3165
alternative hypothesis: true mu is not equal to 0 

Warning message:
cannot compute exact p-value with ties in: wilcox.test.default(mooringdiff) 
R> 
R> 
R> ###################################################
R> ### chunk number 18: SI-water-data
R> ###################################################
R> data("water", package = "HSAUR")
R> 
R> 
R> ###################################################
R> ### chunk number 19: SI-water-plot
R> ###################################################
R> nf <- layout(matrix(c(2, 0, 1, 3), 2, 2, byrow = TRUE),
+              c(2, 1), c(1, 2), TRUE)
R> psymb <- as.numeric(water$location)
R> plot(mortality ~ hardness, data = water, pch = psymb)
R> abline(lm(mortality ~ hardness, data = water))
R> legend("topright", legend = levels(water$location), pch = c(1,2), bty = "n")
R> hist(water$hardness)
R> boxplot(water$mortality)
R> 
R> 
R> ###################################################
R> ### chunk number 20: SI-water-cor
R> ###################################################
R> cor.test(~ mortality + hardness, data = water)

	Pearson's product-moment correlation

data:  mortality and hardness 
t = -6.6555, df = 59, p-value = 1.033e-08
alternative hypothesis: true correlation is not equal to 0 
95 percent confidence interval:
 -0.7783208 -0.4826129 
sample estimates:
       cor 
-0.6548486 

R> 
R> 
R> ###################################################
R> ### chunk number 21: SI-water-cor
R> ###################################################
R> cr <- round(cor.test(~ mortality + hardness, data = water)$estimate, 3)
R> 
R> 
R> ###################################################
R> ### chunk number 22: SI-pistonrings-chisq-hide
R> ###################################################
R> chisqt <- chisq.test(pistonrings)
R> 
R> 
R> ###################################################
R> ### chunk number 23: SI-pistonrings-chisq
R> ###################################################
R> data("pistonrings", package = "HSAUR")
R> chisq.test(pistonrings)

	Pearson's Chi-squared test

data:  pistonrings 
X-squared = 11.7223, df = 6, p-value = 0.06846

R> 
R> 
R> ###################################################
R> ### chunk number 24: SI-pistonrings-resid
R> ###################################################
R> chisq.test(pistonrings)$residuals
          leg
compressor      North     Centre      South
        C1  0.6036154  1.6728267 -1.7802243
        C2  0.1429031  0.2975200 -0.3471197
        C3 -0.3251427 -0.4522620  0.6202463
        C4 -0.4157886 -1.4666936  1.4635235
R> 
R> 
R> ###################################################
R> ### chunk number 25: SI-assoc-plot
R> ###################################################
R> library("vcd")
R> assoc(pistonrings)
R> 
R> 
R> ###################################################
R> ### chunk number 26: SI-rearrests-data
R> ###################################################
R> data("rearrests", package = "HSAUR")
R> rearrests
             Juvenile court
Adult court   Rearrest No rearrest
  Rearrest         158         515
  No rearrest      290        1134
R> 
R> 
R> ###################################################
R> ### chunk number 27: SI-rearrests-mcnemar
R> ###################################################
R> mcs <- round(mcnemar.test(rearrests, correct = FALSE)$statistic, 3)
R> 
R> 
R> ###################################################
R> ### chunk number 28: SI-arrests-mcnemar
R> ###################################################
R> mcnemar.test(rearrests, correct = FALSE)

	McNemar's Chi-squared test

data:  rearrests 
McNemar's chi-squared = 62.8882, df = 1, p-value =
2.188e-15

R> 
R> 
R> ###################################################
R> ### chunk number 29: SI-arrests-binom
R> ###################################################
R> binom.test(rearrests[2], n = sum(rearrests[c(2,3)]))

	Exact binomial test

data:  rearrests[2] and sum(rearrests[c(2, 3)]) 
number of successes = 290, number of trials = 805,
p-value = 1.918e-15
alternative hypothesis: true probability of success is not equal to 0.5 
95 percent confidence interval:
 0.3270278 0.3944969 
sample estimates:
probability of success 
             0.3602484 

R> 
R> 
R> 
