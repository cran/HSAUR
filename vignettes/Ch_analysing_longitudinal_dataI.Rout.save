
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.2.1 beta (2005-12-18 r36792)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ###################################################
> ### chunk number 1: setup
> ###################################################
> rm(list = ls())
> if (!file.exists("tables")) dir.create("tables")
> set.seed(290875)
> options(prompt = "R> ", width = 63, # digits = 4,
+     SweaveHooks = list(leftpar = function()
+         par(mai = par("mai") * c(1, 1.05, 1, 1))))
R> HSAURpkg <- require("HSAUR")
Loading required package: HSAUR
Loading required package: lattice
Loading required package: MASS
Loading required package: scatterplot3d
R> if (!HSAURpkg) stop("cannot load package ", sQuote("HSAUR"))
R> rm(HSAURpkg)
R> 
R> 
R> ###################################################
R> ### chunk number 2: ALDI-setup
R> ###################################################
R> library("Matrix")
R> library("lme4")
R> 
R> 
R> ###################################################
R> ### chunk number 3: ALDI-plot-BtheB
R> ###################################################
R> data("BtheB", package = "HSAUR")
R> layout(matrix(1:2, nrow = 1))
R> ylim <- range(BtheB[,grep("bdi", names(BtheB))], na.rm = TRUE)
R> boxplot(subset(BtheB, treatment == "TAU")[,grep("bdi", names(BtheB))],
+         main = "Treated as usual", ylab = "BDI",
+         xlab = "Time (in months)", names = c(0, 2, 4, 6, 8), ylim = ylim)
R> boxplot(subset(BtheB, treatment == "BtheB")[,grep("bdi", names(BtheB))],
+         main = "Beat the Blues", ylab = "BDI", xlab = "Time (in months)",
+         names = c(0, 2, 4, 6, 8), ylim = ylim)
R> 
R> 
R> ###################################################
R> ### chunk number 4: ALDI-long-BtheB
R> ###################################################
R> data("BtheB", package = "HSAUR")
R> BtheB$subject <- factor(rownames(BtheB))
R> nobs <- nrow(BtheB)
R> BtheB_long <- reshape(BtheB, idvar = "subject",
+                       varying = c("bdi.2m", "bdi.4m", "bdi.6m", "bdi.8m"),
+                       direction = "long")
R> BtheB_long$time <- rep(c(2, 4, 6, 8), rep(nobs, 4))
R> 
R> 
R> ###################################################
R> ### chunk number 5: ALDI-showlong-BtheB
R> ###################################################
R> subset(BtheB_long, subject %in% c("1", "2", "3"))
     drug length treatment bdi.pre subject time bdi
1.2m   No    >6m       TAU      29       1    2   2
2.2m  Yes    >6m     BtheB      32       2    2  16
3.2m  Yes    <6m       TAU      25       3    2  20
1.4m   No    >6m       TAU      29       1    4   2
2.4m  Yes    >6m     BtheB      32       2    4  24
3.4m  Yes    <6m       TAU      25       3    4  NA
1.6m   No    >6m       TAU      29       1    6  NA
2.6m  Yes    >6m     BtheB      32       2    6  17
3.6m  Yes    <6m       TAU      25       3    6  NA
1.8m   No    >6m       TAU      29       1    8  NA
2.8m  Yes    >6m     BtheB      32       2    8  20
3.8m  Yes    <6m       TAU      25       3    8  NA
R> 
R> 
R> ###################################################
R> ### chunk number 6: ALDI-fit-BtheB
R> ###################################################
R> library("lme4")
R> BtheB_lmer1 <- lmer(bdi ~ bdi.pre + time + treatment + drug + length +
+                   (1 | subject), data = BtheB_long,
+                    method = "ML", na.action = na.omit)
R> BtheB_lmer2 <- lmer(bdi ~ bdi.pre + time + treatment + drug + length +
+                   (time | subject), data = BtheB_long,
+                    method = "ML", na.action = na.omit)
R> anova(BtheB_lmer1, BtheB_lmer2)
Data: BtheB_long
Models:
BtheB_lmer1: bdi ~ bdi.pre + time + treatment + drug + length + (1 | subject)
BtheB_lmer2: bdi ~ bdi.pre + time + treatment + drug + length + (time | subject)
            Df     AIC     BIC  logLik  Chisq Chi Df
BtheB_lmer1  8 1886.62 1915.70 -935.31              
BtheB_lmer2 10 1889.81 1926.16 -934.90 0.8161      2
            Pr(>Chisq)
BtheB_lmer1           
BtheB_lmer2      0.665
R> 
R> 
R> ###################################################
R> ### chunk number 7: ALDI-summary-BtheB
R> ###################################################
R> summary(BtheB_lmer1)
Linear mixed-effects model fit by maximum likelihood
Formula: bdi ~ bdi.pre + time + treatment + drug + length + (1 | subject) 
   Data: BtheB_long 
      AIC      BIC   logLik MLdeviance REMLdeviance
 1886.624 1915.702 -935.312   1870.624     1866.149
Random effects:
 Groups   Name        Variance Std.Dev.
 subject  (Intercept) 49.362   7.0258  
 Residual             25.678   5.0673  
# of obs: 280, groups: subject, 97

Fixed effects:
                 Estimate Std. Error  DF t value  Pr(>|t|)    
(Intercept)      5.943659   2.249224 274  2.6425  0.008702 ** 
bdi.pre          0.638192   0.077591 274  8.2250 7.928e-15 ***
time            -0.717018   0.146055 274 -4.9092 1.573e-06 ***
treatmentBtheB  -2.373078   1.663747 274 -1.4263  0.154907    
drugYes         -2.797837   1.719997 274 -1.6267  0.104960    
length>6m        0.256348   1.632189 274  0.1571  0.875315    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Correlation of Fixed Effects:
            (Intr) bdi.pr time   trtmBB drugYs
bdi.pre     -0.678                            
time        -0.264  0.023                     
tretmntBthB -0.389  0.121  0.022              
drugYes     -0.071 -0.237 -0.025 -0.323       
length>6m   -0.238 -0.242 -0.043  0.002  0.158
R> 
R> 
R> 
